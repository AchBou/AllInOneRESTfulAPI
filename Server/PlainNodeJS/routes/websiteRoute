let websiteDAO = require("../DAO/websiteDAO");

function websiteRoute (req ,res,id) {

    switch (req.method) {
        case "GET": getWebsites(req,res,id); break;
        case "POST": addWebsite(req,res); break;
        case "PUT": updateWebsite(req,res ,id); break;
        case "DELETE": deleteWebsite(req,res,id); break;
    }
}

function getWebsites(req,res,id){
    if(id) getOneWebsite(req,res,id);
    else getAllWebsites(req,res);
}

function getOneWebsite(req,res,id){
    websiteDAO.getOneWebsite(id).then((website)=>{
        if(website){
            res.writeHead(201);
            res.end(JSON.stringify(website));
        }
        else{
            res.writeHead(200);
            res.end("There is no such website");
        }
    })
        .catch((err) => {
            console.log(err)
        });
}

function getAllWebsites(req,res){
    websiteDAO.getAllWebsites().then(websites=> {
        res.writeHead(200);
        res.end(JSON.stringify(websites));
    })
        .catch((err) => {
            console.log(err)
        });
}

function addWebsite(req,res) {
    websiteDAO.addWebsite(req)
        .then(()=> {
            res.writeHead(201);
            res.end("Successfully added");
        })
        .catch((err) => {
            console.log(err)
        });
}

function updateWebsite(req,res,id){
    websiteDAO.updateWebsite(req,id)
        .then(()=> {
            res.writeHead(201);
            res.end("Successfully Updated");
        })
        .catch((err) => {
            console.log(err)
        });
}

function deleteWebsite(req,res,id){
    websiteDAO.deleteWebsite(id)
    .then(()=> {
        res.writeHead(201);
        res.end("Successfully deleted");
    })
    .catch((err) => {
        console.log(err)
    });
}

exports.websiteRoute = websiteRoute;